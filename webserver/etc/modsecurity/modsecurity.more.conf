# only those two argument names are allowed
SecRule REQUEST_FILENAME "login.asp""id:400001,phase:2,chain,deny,log,msg:'Unknown Parameter: %{MATCHED_VAR_NAME}'"
SecRule ARGS_NAMES "!@rx ^(username|password|error)$"

# requests to the login page can only contain exactly once the field "username"
SecRule REQUEST_FILENAME "login.asp" "id:400002,phase:2,chain,deny,log,msg:'%{MATCHED_VAR_NAME} occured more than once'"
SecRule &ARGS:username "@gt 1"
SecRule REQUEST_FILENAME "login.asp" "id:400003,phase:2,chain,deny,log,msg:'%{MATCHED_VAR_NAME} is missing!'"
SecRule &ARGS:username "@lt 1"

# requests to the login page can only contain exactly once the field "password"
SecRule REQUEST_FILENAME "login.asp" "id:400004,phase:2,chain,deny,log,msg:'%{MATCHED_VAR_NAME} occurred more than once'"
SecRule &ARGS:password "@gt 1"
SecRule REQUEST_FILENAME "login.asp" "id:400005,phase:2,chain,deny,log,msg:'%{MATCHED_VAR_NAME} is missing!'"
SecRule &ARGS:password "@lt 1"

# we only allow characters and numbers as valid fields
SecRule REQUEST_FILENAME "login.asp" "id:400006,phase:2,chain,deny,log,msg:'Invalid format: %{MATCHED_VAR_NAME} (%{MATCHED_VAR})'"
SecRule ARGS:username "!@rx ^[a-zA-Z0-9]{1,64}$" 

SecRule REQUEST_FILENAME "login.asp" "id:400007,phase:2,chain,deny,log,msg:'Invalid format: %{MATCHED_VAR_NAME} (%{MATCHED_VAR})'"
SecRule ARGS:password "!@rx ^[a-zA-Z0-9]{1,64}$" 